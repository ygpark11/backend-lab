# Level 1: JVM 메모리 구조와 GC의 이해 (with VisualVM)

## 📝 학습 목표

- JVM Heap 메모리의 구조(Young Gen, Old Gen)를 이해하고, 각 영역의 역할을 설명할 수 있음.
- Minor GC와 Major GC의 차이점을 이해하고, 시스템에 미치는 영향을 설명할 수 있음.
- VisualVM과 Visual GC 플러그인을 사용하여 실행 중인 자바 애플리케이션의 메모리 상태와 GC 동작을 실시간으로 모니터링할 수 있음.

## 📚 학습 목차

1.  **[JVM Heap 메모리: 주방의 작업 공간](#1-jvm-heap-메모리-주방의-작업-공간)**
2.  **[Minor GC: 가벼운 도마 정리](#2-minor-gc-가벼운-도마-정리)**
3.  **[Major GC와 G1 GC의 특징](#3-major-gc와-g1-gc의-특징)**
4.  **[질문과 답변으로 얻은 깨달음](#4-질문과-답변으로-얻은-깨달음)**

---

## 🚀 핵심 학습 내용

### 1. JVM Heap 메모리: 주방의 작업 공간

- **개념**: 자바 애플리케이션의 객체(데이터)가 생성되고 소멸하는 핵심적인 메모리 영역. 효율적인 청소(GC)를 위해 여러 구역으로 나뉨.



| 영역 | 비유 | 역할 |
| :--- | :--- | :--- |
| **Eden** | 🍳 **메인 도마** | 새로 생성된 대부분의 객체가 할당되는 공간. |
| **Survivor (S0, S1)**| 🍽️ **임시 보관 접시** | Eden에서 살아남은 객체들이 잠시 머무는 공간. |
| **Old Generation** | 🧊 **대형 냉장고** | 여러 번의 GC에도 살아남은 '장기 생존' 객체들이 보관되는 공간. |

### 2. Minor GC: 가벼운 도마 정리

- **언제?**: '메인 도마(Eden)'가 꽉 찼을 때 발생.
- **어떻게?**: Eden과 Survivor 공간 중 하나(From)에 있는 '살아남은' 객체만 다른 Survivor 공간(To)으로 복사하고, Eden과 From 공간을 깨끗하게 비움.
- **특징**: 매우 빠르고 빈번하게 발생하며, 애플리케이션에 미치는 영향이 적음.

### 3. Major GC와 G1 GC의 특징

- **Major GC**: '대형 냉장고(Old Gen)'가 꽉 찼을 때 발생하는 '대청소'. Minor GC보다 훨씬 오래 걸리며, 이 동안 애플리케이션 전체가 멈추는 **'Stop-the-World'** 현상을 유발할 수 있음.
- **G1 GC의 특징**: 최신 자바의 기본 GC. '거대 객체(Humongous Object)'를 감지하면, Eden을 거치지 않고 바로 Old Gen에 할당하는 최적화 로직이 있음. 이 때문에 의도적으로 Major GC를 발생시키기 어려웠음.

### 4. 질문과 답변으로 얻은 깨달음

- **Q: 앱 시작 직후 Old Gen이 차오르다가, 잠시 후 잠잠해지는 이유는?**
    - **A:** 시작 시 `DataInitializer`가 만든 '장기 생존' 객체(10만 개 User)들이 Old Gen으로 승급(Promotion)하기 때문. 작업이 끝나면 앱이 안정 상태에 접어들어 Old Gen의 변화가 없어짐.

- **Q: 앱이 아무것도 안 하는데 Eden이 계속 움직이는 이유는?**
    - **A:** VisualVM과 우리 앱이 상태 정보를 주고받기 위해 생성하는 '아주 짧게 쓰이는' 통신용 임시 객체들 때문. 이 객체들은 생성되자마자 Minor GC에 의해 즉시 제거됨.

- **Q: Eden이 비워지면 모든 객체가 Survivor로 가나?**
    - **A:** 아니오. **'살아남은' 객체만** Survivor로 가고, 대부분의 '쓰레기' 객체는 그냥 버려짐.

- **Q: Survivor 0과 1의 역할은 다른가?**
    - **A:** 역할은 동일. Minor GC 때마다 하나는 'From 공간'(청소 대상), 다른 하나는 'To 공간'(대피 장소)으로 역할을 주고받는 파트너 관계.

- **Q: 애플리케이션을 종료하면 메모리는 어떻게 되나?**
    - **A:** 운영체제(OS)가 앱이 사용하던 모든 메모리(Heap 포함)를 회수하여 완전히 깨끗해짐.